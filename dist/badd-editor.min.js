!function(){var e=angular.module("baddEditor",[]),t=function(e,t){e.title=angular.isDefined(e.title)?e.title:"Bootstrap visual editor",e.componentsTitle=angular.isDefined(e.componentsTitle)?e.componentsTitle:"Components",e.propertiesTitle=angular.isDefined(e.propertiesTitle)?e.propertiesTitle:"Properties",t.addEventListener("message",function(){alert("received something")}),e.components=[{title:"Header 1",label:"h1",element:"<h1>New Header 1</h1>"},{title:"Header 2",label:"h2",element:"<h2>New Header 2</h2>"},{title:"Header 3",label:"h3",element:"<h3>New Header 3</h3>"},{title:"Header 4",label:"h4",element:"<h4>New Header 4</h4>"},{title:"Button",label:"btn",element:'<button class="btn btn-primary" badd-draggable>New Button</button>'}]};t.$inject=["$scope","$window"];var n=function(){return{restrict:"E",templateUrl:"badd-editor.html",scope:{title:"@",componentsTitle:"@",propertiesTitle:"@",template:"@"},controller:t}};e.directive("baddEditor",n);var i=function(){var e=this;e.uniqueCounter=0,e.getNextUniqueClass=function(){return e.uniqueCounter=e.uniqueCounter+1,"badd-editor-unique-"+e.uniqueCounter},e.getLastUniqueClass=function(){return"badd-editor-unique-"+e.uniqueCounter}};e.service("editorService",i)}();
!function(){var e=angular.module("baddEditor"),a=function(){return{restrict:"A",link:function(e,a){var r=$("iframe.badd-editor-browser").offset();r.left=r.left+62,r.top=r.top+22,a.draggable({revert:!1,helper:"clone",iframeFix:!0,cursorAt:r,drag:function(){$(this).addClass("drag-active"),$(this).closest(a).addClass("drag-active")},stop:function(e,r){$(this).removeClass("drag-active").closest(a).removeClass("drag-active")}})}}};e.directive("baddDraggable",a)}();
!function(){var e=angular.module("baddEditor"),t=function(e){return{restrict:"E",scope:{template:"@"},replace:!0,template:'<iframe class="badd-editor-browser"></iframe>',link:function(t,a,r){"IFRAME"===a.prop("tagName")&&(a.attr("src",r.template),a.load(function(){var r=a.contents().find("html");r.attr("ng-app","baddEditor");var d=r.find("head");d.append('<link rel="stylesheet" href="badd-editor-frame.min.css" type="text/css" />');var n=r.find("body");n.attr("badd-droppable",""),n.attr("ng-controller","editablePageController as ctrl");var l=n.find("div");l.attr("badd-droppable",""),l.attr("ng-click","ctrl.sendMessage()"),e(r)(t)}))}}};t.$inject=["$compile"],e.directive("baddDroppableFrame",t);var a=function(e){var t=this;t.message="Hello darling",t.sendMessage=function(){e.postMessage(t.message,"*")}};a.$inject=["$window"],e.controller("editablePageController",a)}();
!function(){var e=angular.module("baddEditor"),t=function(e,t){function r(e){e.each(function(){return $(this).hasClass(d.entered)?void a($(this)):void 0})}function a(e){e.removeClass(d.entered),d.entered=null;var t=e.parents("body");t.find(".badd-highlighter").remove(),d.objectPreview&&d.objectPreview.remove()}function o(e){if(!(0>e)){var t=null;d.droppableTarget.children().each(function(){e<=$(this).offset().top&&(t=$(this))}),a(d.droppableTarget),d.objectPreview=$(d.droppableObject.draggable.data("raw")),t?d.objectPreview.insertBefore(t):d.droppableTarget.append(d.objectPreview),d.updatePreview=!1}}function i(){d.mouseListenerRegistered||(n(),$("html").mousemove(function(e){if(d.droppableTarget&&d.droppableObject){o(e.pageY-d.iframeOffsetY);var t=d.droppableTarget.offset(),r=d.droppableTarget.outerWidth(),a=d.droppableTarget.outerHeight(),i=d.droppableTarget.parents("body");i.append('<div class="badd-highlighter" style="position: fixed; top: '+t.top+"px ; left: "+t.left+"px ; width: "+r+"px; height: "+a+'px; border: 2px dashed lightskyblue;" />')}}),d.mouseListenerRegistered=!0)}function n(){var e=$("html").find("iframe.badd-editor-browser");d.iframeOffsetY=e.offset().top}var d=this;return d.entered=null,d.mouseListenerRegistered=!1,d.iframeOffsetY=null,d.droppableObject=null,d.droppableTarget=null,d.objectEntering=function(e,a){i(),r($(this).parents()),d.entered||(d.entered=t.getNextUniqueClass(),$(this).addClass(d.entered),d.droppableObject=a,d.droppableTarget=$(this))},d.objectLeaving=function(){d.entered&&$(this).hasClass(d.entered)&&(d.droppableTarget=null,a($(this)))},d.objectDropped=function(t){return function(r,o){var i=angular.element(o.draggable).data("raw"),n=angular.element(o.draggable),l=angular.element(this);a(l),void 0==i&&(i=$(n)[0].outerHTML),e(i)(t).appendTo(l),d.objectLeaving(r),d.droppableObject=null,d.droppableTarget=null}},{restrict:"A",link:function(e,t){t.droppable({activeClass:"drop-active",greedy:!0,hoverClass:"drop-hover",iframeFix:!0,tolerance:"intersect",over:d.objectEntering,out:d.objectLeaving,drop:d.objectDropped(e)})}}};t.$inject=["$compile","editorService"],e.directive("baddDroppable",t)}();
angular.module("baddEditor").run(["$templateCache", function($templateCache) {$templateCache.put("badd-editor.html","<table class=\"badd-editor\">\n	<tr>\n		<td class=\"badd-editor-header\" colspan=\"3\">\n			<div class=\"col-xs-12\">\n				<p class=\"badd-editor-title\">{{title}}</p>\n			</div>\n		</td>\n	</tr>\n	<tr>\n		<td class=\"badd-editor-components\">\n			<div class=\"badd-editor-components\">\n				<p class=\"badd-editor-title\">{{componentsTitle}}</p>\n				<ul>\n					<li ng-repeat=\"component in components\" data-raw=\"{{component.element}}\" badd-draggable>\n						<span class=\"label label-default badd-editor-label\">{{component.label}}</span> <span class=\"badd-editor-title\">{{component.title}}</span><i class=\"fa fa-arrows-alt\"></i>\n					</li>\n				</ul>\n			</div>\n		</td>\n		<td class=\"badd-editor-browser\">\n			<badd-droppable-frame template=\"{{template}}\"></badd-droppable-frame>\n		</td>\n		<td class=\"badd-editor-properties\">\n			<div class=\"badd-editor-properties\">\n				<p class=\"badd-editor-title\">{{propertiesTitle}}</p>\n				hi\n			</div>\n		</td>\n	</tr>\n</table>");}]);