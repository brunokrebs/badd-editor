!function(){var e=angular.module("baddEditor",[]),t=function(e,t){e.title=angular.isDefined(e.title)?e.title:"Bootstrap visual editor",e.componentsTitle=angular.isDefined(e.componentsTitle)?e.componentsTitle:"Components",t.addEventListener("message",function(){alert("received something")}),e.draggables=[{titleLg:"Row",title:"ROW",label:"row",element:'<div class="row"><div class="col-xs-12"><p>A simple row with a single column</p></div></div>'},{titleLg:"Column",title:"COL",label:"col",element:'<div class="col-xs-12"><p>You can make me a smaller column</p></div>'},{titleLg:"Header 1",title:"H1",label:"h1",element:"<h1>An important title</h1>"},{titleLg:"Header 2",title:"H2",label:"h2",element:"<h2>A secondary title</h2>"},{titleLg:"Header 3",title:"H3",label:"h3",element:"<h3>A third level title</h3>"},{titleLg:"Header 4",title:"H4",label:"h4",element:"<h4>A fourth level title</h4>"},{titleLg:"Paragraph",title:"P",label:"p",element:"<p>Write something useful here</p>"},{titleLg:"Button",title:"BTN",label:"btn",element:'<btn class="btn btn-primary">My brand new button</btn>'},{titleLg:"Jumbotron",title:"JMB",label:"jmb",element:'<div class="jumbotron"><h1>Hello, world!</h1><p>My name is Jumbotron</p></div>'},{titleLg:"Panel",title:"PNL",label:"pnl",element:'<div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title">Panel title</h3></div><div class="panel-body">Panel content</div></div>'},{titleLg:"Well",title:"WLL",label:"wll",element:'<div class="well">Look, I\'m in a well.</div>'},{titleLg:"Image",title:"IMG",label:"img",element:'<img src="http://www.avjobs.com/images/v_png_v5/v_collection_png/256x256/shadow/airplane2.png" alt="airplane">'}]};t.$inject=["$scope","$window"];var i=function(){return{restrict:"E",templateUrl:"badd-editor.html",scope:{title:"@",componentsTitle:"@",template:"@"},controller:t}};e.directive("baddEditor",i);var l=function(e,t,i){function l(e){if("badd-highlight"!==e.className&&"badd-transfer-area"!==e.className){"DIV"===e.tagName&&""!==e.getAttribute("badd-droppable")&&e.setAttribute("badd-droppable",""),""!==e.getAttribute("badd-draggable")&&(e.setAttribute("badd-draggable",""),e.setAttribute("badd-configurable",""));var t=_.toArray(e.querySelectorAll("*"));t.forEach(l)}}var r=this;r.initializeFrame=function(a,n){return function(){r.document=t[0],i.addEventListener("click",r.hideConfigurationModal),r.configurationModal=r.document.querySelector(".badd-configuration-modal"),r.iframe=a[0],r.iframePosition=r.iframe.getBoundingClientRect(),r.frame=a.contents()[0],r.frame.addEventListener("scroll",r.updateHighlightBorderPosition),r.frameHtml=r.frame.querySelector("html"),r.frameHead=r.frame.querySelector("head"),r.frameBody=r.frame.querySelector("body"),r.transferArea=r.document.createElement("div"),r.transferArea.className="badd-transfer-area",r.frameBody.appendChild(r.transferArea),r.transferArea.innerHTML='<svg class="badd-highlighter"></svg>',r.highlightBorder=r.transferArea.childNodes[0],r.frameBody.appendChild(r.highlightBorder),r.frameHtml.setAttribute("ng-app","baddEditor"),r.stylesheet=r.document.createElement("link"),r.stylesheet.setAttribute("rel","stylesheet"),r.stylesheet.setAttribute("href","badd-editor-frame.min.css"),r.stylesheet.setAttribute("type","text/css"),r.frameHead.appendChild(r.stylesheet),r.frameBody.setAttribute("badd-droppable",""),r.frameBody.setAttribute("badd-configurable","");var o=_.toArray(r.frameBody.querySelectorAll("*"));o.forEach(l),r.showConfigurationModal=!1,r.scope=n,e(r.frameHtml)(n)}},r.startDragging=function(e){e.dataTransfer.setData("text","firefox needs data"),""===e.target.getAttribute("badd-configurable")?r.previewElement=e.target:(r.transferArea.innerHTML=e.target.getAttribute("data-element"),r.previewElement=r.transferArea.querySelector("*"))},r.stopDragging=function(e){r.transferArea.innerHTML="",r.previewElement&&r.previewElement.parentNode&&(r.previewElement.parentNode.removeChild(r.previewElement),r.previewElement=null),r.hideHighlightBorder()},r.elementEntering=function(e){r.previewElement.classList.remove("badd-hidden-preview-element"),e.stopPropagation(),e.preventDefault()},r.elementLeaving=function(e){var t=r.document.elementFromPoint(e.clientX+r.iframePosition.left,e.clientY+r.iframePosition.top);null!=t&&"IFRAME"===t.tagName&&_.contains(t.classList,"badd-editor-browser")||(r.previewElement.classList.add("badd-hidden-preview-element"),r.hideHighlightBorder())},r.elementHovering=function(e){if(e.stopPropagation(),e.preventDefault(),e.target.getAttribute&&e.target!==r.previewElement&&""===e.target.getAttribute("badd-droppable")){var t=_.toArray(e.target.childNodes),i=null,l=null;t.forEach(function(t){if(t.getBoundingClientRect&&"badd-transfer-area"!=t.className&&"badd-highlighter"!=t.className&&t!=r.previewElement){var a=t.getBoundingClientRect(),n={X:a.width/2+a.left,Y:a.height/2+a.top},o=n.Y;o-a.top>30&&(o=a.top+30);var d=n.X;d-a.left>30&&(d=a.left+30),e.clientY>o&&e.clientX>d||e.clientY>a.bottom||(null==i?(i=t,l=a):l.left>=a.left&&l.top>=a.top&&(i=t,l=a))}}),i?e.target.insertBefore(r.previewElement,i):e.target.appendChild(r.previewElement),r.showHighlightBorder(e.target)}},r.elementDropped=function(t){t.stopPropagation(),t.preventDefault(),l(r.previewElement),e(r.previewElement)(r.scope),r.previewElement=null},r.updateHighlightBorderPosition=function(){"block"===r.highlightBorder.style.display&&r.lastHoveredTarget&&r.showHighlightBorder(r.lastHoveredTarget)},r.showHighlightBorder=function(e){var t=e.getBoundingClientRect();r.highlightBorder.style.top=t.top+"px",r.highlightBorder.style.left=t.left+"px",r.highlightBorder.style.width=e.offsetWidth+"px",r.highlightBorder.style.height=e.offsetHeight+"px",r.highlightBorder.style.display="block",r.lastHoveredTarget=e},r.hideHighlightBorder=function(){r.highlightBorder.style.display="none",r.highlightBorder.style.top=0,r.highlightBorder.style.left=0,r.highlightBorder.style.width=0,r.highlightBorder.style.height=0},r.mouseHovering=function(e){e.stopPropagation(),e.preventDefault(),r.showHighlightBorder(e.target)},r.mouseClick=function(e){e.stopPropagation(),e.preventDefault(),r.configurationModal.style.left=r.iframePosition.left+e.clientX+"px",r.configurationModal.style.top=r.iframePosition.top+e.clientY+"px",r.scope.$apply(function(){r.showConfigurationModal=!0})},r.hideConfigurationModal=function(e){e.stopPropagation(),e.preventDefault(),r.scope.$apply(function(){r.showConfigurationModal=!1})},r.mouseLeaving=function(e){e.stopPropagation(),e.preventDefault(),r.hideHighlightBorder()}};l.$inject=["$compile","$document","$window"],e.service("editorService",l)}();
!function(){var e=angular.module("baddEditor"),i=function(e,i){return{restrict:"A",link:function(e,n){var r=n[0];r.addEventListener("mouseover",i.mouseHovering),r.addEventListener("click",i.mouseClick),r.addEventListener("mouseout",i.mouseLeaving)}}};i.$inject=["$compile","editorService"],e.directive("baddConfigurable",i)}();
!function(){var r=angular.module("baddEditor"),t=function(r,t){var o=this;o.editorService=t};t.$inject=["$scope","editorService"];var o=function(){return{restrict:"E",templateUrl:"badd-configuration-modal.html",controller:t,controllerAs:"ctrl"}};r.directive("baddConfigurationModal",o)}();
!function(){var t=angular.module("baddEditor"),r=function(t){return{restrict:"A",link:function(r,e){var a=e[0];a.setAttribute("draggable","true"),a.addEventListener("dragstart",t.startDragging,!1),a.addEventListener("dragend",t.stopDragging,!1)}}};r.$inject=["editorService"],t.directive("baddDraggable",r)}();
!function(){var e=angular.module("baddEditor"),r=function(e,r){return{restrict:"E",scope:{template:"@"},replace:!0,template:'<iframe class="badd-editor-browser"></iframe>',link:function(e,a,t){"IFRAME"===a.prop("tagName")&&(a.attr("src",t.template),a.on("load",r.initializeFrame(a,e)))}}};r.$inject=["$compile","editorService"],e.directive("baddDroppableFrame",r)}();
!function(){var e=angular.module("baddEditor"),n=function(e,n){return{restrict:"A",link:function(e,r){var t=r[0];t.addEventListener("dragenter",n.elementEntering),t.addEventListener("dragleave",n.elementLeaving),t.addEventListener("dragover",n.elementHovering),t.addEventListener("drop",n.elementDropped)}}};n.$inject=["$compile","editorService"],e.directive("baddDroppable",n)}();
angular.module("baddEditor").run(["$templateCache", function($templateCache) {$templateCache.put("badd-configuration-modal.html","<div class=\"panel panel-default badd-configuration-modal\" ng-show=\"ctrl.editorService.showConfigurationModal\">\n	<div class=\"panel-heading\">\n		<h4>Configuration options</h4>\n	</div>\n	<div class=\"panel-body\">\n		<input type=\"text\" placeholder=\"Element text\" ng-model=\"ctrl.text\" />\n		<button ng-click=\"ctrl.showModal()\" class=\"btn btn-success\">Go Horse</button>\n	</div>\n</div>");
$templateCache.put("badd-editor.html","<table class=\"badd-editor\">\n	<tr>\n		<td class=\"badd-editor-header\" colspan=\"2\">\n			<div class=\"col-xs-12\">\n				<p class=\"badd-editor-title\">{{title}}</p>\n			</div>\n		</td>\n	</tr>\n	<tr>\n		<td class=\"badd-editor-components\">\n			<div class=\"badd-editor-components\">\n				<p class=\"badd-editor-title\">{{componentsTitle}}</p>\n				<ul>\n					<li ng-repeat=\"draggable in draggables\" data-element=\"{{draggable.element}}\" badd-draggable>\n						<span class=\"label label-default badd-editor-label\">{{draggable.label}}</span>\n						<span class=\"badd-editor-title visible-lg-inline\">{{draggable.titleLg}}</span>\n						<span class=\"badd-editor-title visible-md-inline\">{{draggable.title}}</span>\n						<span class=\"badd-editor-title\"> </span>\n						<i class=\"fa fa-arrows-alt\"></i>\n					</li>\n				</ul>\n			</div>\n			<badd-configuration-modal></badd-configuration-modal>\n		</td>\n		<td class=\"badd-editor-browser\">\n			<badd-droppable-frame template=\"{{template}}\"></badd-droppable-frame>\n		</td>\n	</tr>\n</table>");}]);