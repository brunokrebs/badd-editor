!function(){var e=angular.module("baddEditor",[]),t=function(e){e.componentsTitle=angular.isDefined(e.componentsTitle)?e.componentsTitle:"Components",e.draggables=[{title:"Container",icon:"fa-square-o",element:'<div class="container"><div class="row"><div class="col-xs-12"><p>A simple row with a single column</p></div></div></div>'},{title:"Row",icon:"fa-align-justify",element:'<div class="row"><div class="col-xs-12"><p>A simple row with a single column</p></div></div>'},{title:"Column",icon:"fa-columns",element:'<div class="col-xs-12"><p>You can make me a smaller column</p></div>'},{title:"Header 1",icon:"fa-header",element:"<h1>An important title</h1>"},{title:"Paragraph",icon:"fa-align-left",element:"<p>Write something useful here</p>"},{title:"Button",icon:"fa-plus-square",element:'<btn class="btn btn-primary">My brand new button</btn>'},{title:"Image",icon:"fa-picture-o",element:'<img src="http://www.avjobs.com/images/v_png_v5/v_collection_png/256x256/shadow/airplane2.png"alt="airplane">'}]};t.$inject=["$scope"];var i=function(){return{restrict:"E",templateUrl:"badd-editor.html",scope:{title:"@",componentsTitle:"@",template:"@"},controller:t}};e.directive("baddEditor",i);var n=function(e,t,i){function n(e){if("badd-highlight"!==e.className&&"badd-transfer-area"!==e.className&&"badd-editor-content-edition"!==e.className){"DIV"===e.tagName&&""!==e.getAttribute("badd-droppable")&&e.setAttribute("badd-droppable",""),""!==e.getAttribute("badd-draggable")&&(e.setAttribute("badd-draggable",""),e.setAttribute("badd-configurable",""));var t=_.toArray(e.querySelectorAll("*"));t.forEach(n)}}function r(){var e=l.document.querySelector("td.badd-editor-components"),t=l.document.querySelector("div.badd-editor-browser-frame");t.style.height=e.getBoundingClientRect().height-1+"px",l.iframe.style.height=e.getBoundingClientRect().height-140+"px";var i=l.document.querySelector("div.badd-editor-browser-address"),n=i.querySelector("div.badd-editor-browser-address-page-title");n.style.width=i.getBoundingClientRect().width-75+"px"}function o(e){e.stopPropagation(),e.preventDefault(),l.hideSelectedHighlightBorder()}var l=this;l.initializeFrame=function(d,a){return function(){l.document=t[0],l.iframe=d[0],r(),i.addEventListener("click",o),l.iframePosition=l.iframe.getBoundingClientRect(),l.frame=d.contents()[0],l.frame.addEventListener("scroll",l.updateHighlightBorderPosition),l.frameHtml=l.frame.querySelector("html"),l.frameHead=l.frame.querySelector("head"),l.frameBody=l.frame.querySelector("body"),l.pageTitle=l.frame.querySelector("title"),l.pageTitle?a.$apply(function(){a.pageTitle=l.pageTitle.textContent}):l.pageTitle=l.document.createElement("title"),l.transferArea=l.document.createElement("div"),l.transferArea.className="badd-transfer-area",l.frameBody.appendChild(l.transferArea),l.transferArea.innerHTML='<svg class="badd-highlighter"></svg>',l.highlightBorder=l.transferArea.childNodes[0],l.frameBody.appendChild(l.highlightBorder),l.transferArea.innerHTML='<svg class="badd-selected-highlighter"></svg>',l.selectedHighlightBorder=l.transferArea.childNodes[0],l.frameBody.appendChild(l.selectedHighlightBorder),l.frameHtml.setAttribute("ng-app","baddEditor"),l.stylesheet=l.document.createElement("link"),l.stylesheet.setAttribute("rel","stylesheet"),l.stylesheet.setAttribute("href","badd-editor-frame.min.css"),l.stylesheet.setAttribute("type","text/css"),l.frameHead.appendChild(l.stylesheet),l.frameBody.setAttribute("badd-droppable",""),l.frameBody.setAttribute("badd-configurable",""),l.transferArea.innerHTML='<textarea resizable="false" class="badd-editor-content-edition"></textarea>',l.contentEdition=l.transferArea.childNodes[0],l.contentEdition.addEventListener("blur",l.hideContentEditionArea),l.frameBody.appendChild(l.contentEdition);var s=_.toArray(l.frameBody.querySelectorAll("*"));s.forEach(n),l.scope=a,e(l.frameHtml)(a)}},l.changePageTitle=function(e){l.pageTitle.textContent=e},l.startDragging=function(e){e.dataTransfer.setData("text","firefox needs data"),""===e.target.getAttribute("badd-configurable")?(l.previewElement=e.target,l.hideSelectedHighlightBorder()):(l.transferArea.innerHTML=e.target.getAttribute("data-element"),l.previewElement=l.transferArea.querySelector("*"))},l.stopDragging=function(e){l.transferArea.innerHTML="",l.previewElement&&l.previewElement.parentNode&&(l.previewElement.parentNode.removeChild(l.previewElement),l.previewElement=null),l.hideHighlightBorder()},l.elementEntering=function(e){l.previewElement.classList.remove("badd-hidden-preview-element"),e.stopPropagation(),e.preventDefault()},l.elementLeaving=function(e){var t=l.document.elementFromPoint(e.clientX+l.iframePosition.left,e.clientY+l.iframePosition.top);null!=t&&"IFRAME"===t.tagName&&_.contains(t.classList,"badd-editor-browser")||(l.previewElement.classList.add("badd-hidden-preview-element"),l.hideHighlightBorder())},l.elementHovering=function(e){if(e.stopPropagation(),e.preventDefault(),e.target.getAttribute&&e.target!==l.previewElement&&""===e.target.getAttribute("badd-droppable")){var t=_.toArray(e.target.childNodes),i=null,n=null;t.forEach(function(t){if(t.getBoundingClientRect&&"badd-transfer-area"!=t.className&&"badd-highlighter"!=t.className&&"badd-editor-content-edition"!=t.className&&t!=l.previewElement){var r=t.getBoundingClientRect(),o={X:r.width/2+r.left,Y:r.height/2+r.top},d=o.Y;d-r.top>30&&(d=r.top+30);var a=o.X;a-r.left>30&&(a=r.left+30),e.clientY>d&&e.clientX>a||e.clientY>r.bottom||(null==i?(i=t,n=r):n.left>=r.left&&n.top>=r.top&&(i=t,n=r))}}),i?e.target.insertBefore(l.previewElement,i):e.target.appendChild(l.previewElement),l.showHighlightBorder(e.target)}},l.elementDropped=function(t){t.stopPropagation(),t.preventDefault(),n(l.previewElement),e(l.previewElement)(l.scope),l.previewElement=null},l.updateHighlightBorderPosition=function(){"block"===l.highlightBorder.style.display&&l.lastHoveredTarget&&l.showHighlightBorder(l.lastHoveredTarget)},l.showHighlightBorder=function(e){var t=e.getBoundingClientRect();l.highlightBorder.style.top=t.top+"px",l.highlightBorder.style.left=t.left+"px",l.highlightBorder.style.width=e.offsetWidth+"px",l.highlightBorder.style.height=e.offsetHeight+"px",l.highlightBorder.style.display="block",l.lastHoveredTarget=e},l.showSelectedHighlightBorder=function(e){var t=e.getBoundingClientRect();l.selectedHighlightBorder.style.top=t.top+"px",l.selectedHighlightBorder.style.left=t.left+"px",l.selectedHighlightBorder.style.width=e.offsetWidth+"px",l.selectedHighlightBorder.style.height=e.offsetHeight+"px",l.selectedHighlightBorder.style.display="block"},l.hideSelectedHighlightBorder=function(){l.selectedHighlightBorder.style.display="none",l.selectedHighlightBorder.style.top=0,l.selectedHighlightBorder.style.left=0,l.selectedHighlightBorder.style.width=0,l.selectedHighlightBorder.style.height=0},l.hideHighlightBorder=function(){l.highlightBorder.style.display="none",l.highlightBorder.style.top=0,l.highlightBorder.style.left=0,l.highlightBorder.style.width=0,l.highlightBorder.style.height=0},l.mouseHovering=function(e){e.stopPropagation(),e.preventDefault(),"badd-transfer-area"!==e.target.className&&"badd-highlighter"!==e.target.className&&"badd-editor-content-edition"!==e.target.className&&l.showHighlightBorder(e.target)},l.mouseClick=function(e){e.stopPropagation(),e.preventDefault(),l.showSelectedHighlightBorder(e.target),"P"===e.target.tagName&&l.showContentEditionArea(e.target)},l.showContentEditionArea=function(e){var t=e.getBoundingClientRect();l.contentEdition.style.display="block",l.contentEdition.style.top=t.top+"px",l.contentEdition.style.left=t.left+"px",l.contentEdition.style.width=e.offsetWidth+"px",l.contentEdition.style.height=e.offsetHeight+"px";var n=i.getComputedStyle(e);l.contentEdition.style.color=n.color,l.contentEdition.style.fontSize=n.fontSize,l.contentEdition.style.fontFamily=n.fontFamily,l.contentEdition.style.padding=n.padding,l.contentEdition.style.margin=n.margin,l.contentEdition.style.lineHeight=n.lineHeight,l.contentEdition.value=e.innerHTML.replace(/<br>/g,"\n"),e.style.color="transparent",l.hideSelectedHighlightBorder(),l.elementBeingEdited=e,l.contentEdition.setSelectionRange(0,0)},l.hideContentEditionArea=function(){l.elementBeingEdited.style.color=l.contentEdition.style.fontSize,l.elementBeingEdited.style.color=l.contentEdition.style.fontFamily,l.elementBeingEdited.style.color=l.contentEdition.style.padding,l.elementBeingEdited.style.color=l.contentEdition.style.margin,l.elementBeingEdited.style.color=l.contentEdition.style.lineHeight,l.elementBeingEdited.innerHTML=l.contentEdition.value.replace(/\n/g,"<br>"),l.elementBeingEdited.style.color=l.contentEdition.style.color,l.contentEdition.style.display="none",l.contentEdition.style.top=0,l.contentEdition.style.left=0,l.contentEdition.style.width=0,l.contentEdition.style.height=0,l.elementBeingEdited=null},l.mouseLeaving=function(e){e.stopPropagation(),e.preventDefault(),l.hideHighlightBorder()}};n.$inject=["$compile","$document","$window"],e.service("editorService",n)}();
!function(){var e=angular.module("baddEditor"),i=function(e,i){return{restrict:"A",link:function(e,n){var r=n[0];r.addEventListener("mouseover",i.mouseHovering),r.addEventListener("click",i.mouseClick),r.addEventListener("mouseout",i.mouseLeaving)}}};i.$inject=["$compile","editorService"],e.directive("baddConfigurable",i)}();
!function(){var t=angular.module("baddEditor"),r=function(t){return{restrict:"A",link:function(r,e){var a=e[0];a.setAttribute("draggable","true"),a.addEventListener("dragstart",t.startDragging,!1),a.addEventListener("dragend",t.stopDragging,!1)}}};r.$inject=["editorService"],t.directive("baddDraggable",r)}();
!function(){var e=angular.module("baddEditor"),t=function(e,t){e.pageTitleChanged=function(){t.changePageTitle(e.pageTitle)}};t.$inject=["$scope","editorService"];var a=function(e,a){return{restrict:"E",scope:{template:"@"},replace:!0,templateUrl:"badd-droppable-frame.html",controller:t,link:function(e,t,i){var r=t.find("iframe");r.attr("src",i.template),r.on("load",a.initializeFrame(r,e))}}};a.$inject=["$compile","editorService"],e.directive("baddDroppableFrame",a)}();
!function(){var e=angular.module("baddEditor"),n=function(e,n){return{restrict:"A",link:function(e,r){var t=r[0];t.addEventListener("dragenter",n.elementEntering),t.addEventListener("dragleave",n.elementLeaving),t.addEventListener("dragover",n.elementHovering),t.addEventListener("drop",n.elementDropped)}}};n.$inject=["$compile","editorService"],e.directive("baddDroppable",n)}();
angular.module("baddEditor").run(["$templateCache", function($templateCache) {$templateCache.put("badd-droppable-frame.html","<div class=\"badd-editor-browser-frame\">\n	<div class=\"badd-editor-browser-header\">\n		<div class=\"badd-editor-browser-header-close\"></div>\n		<div class=\"badd-editor-browser-header-min\"></div>\n		<div class=\"badd-editor-browser-header-max\"></div>\n	</div>\n	<div class=\"badd-editor-browser-address\">\n		<div class=\"badd-editor-browser-address-undo-redo\">\n			<div class=\"badd-editor-browser-address-return\">\n				<i class=\"fa fa-arrow-left\"></i>\n			</div>\n			<div class=\"badd-editor-browser-address-redo\">\n				<i class=\"fa fa-arrow-right\"></i>\n			</div>\n		</div>\n		<div class=\"badd-editor-browser-address-page-title\">\n			<input type=\"text\" class=\"form-control\" placeholder=\"Page title\"\n				   ng-model=\"pageTitle\" ng-change=\"pageTitleChanged()\">\n		</div>\n	</div>\n	<div class=\"badd-editor-browser-configuration\">\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Font\">\n			Arial <span class=\"caret\"></span>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Font size\">\n			11 <span class=\"fa fa-caret-up\"></span> <span class=\"fa fa-caret-down\"></span>\n		</button>\n		<div class=\"btn-separator\"></div>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Bold\">\n			<i class=\"fa fa-bold\"></i>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Italic\">\n			<i class=\"fa fa-italic\"></i>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Underline\">\n			<i class=\"fa fa-underline\"></i>\n		</button>\n		<div class=\"btn-separator\"></div>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Font color\">\n			<strong>F</strong>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Background color\">\n			<i class=\"fa fa-square\"></i>\n		</button>\n		<div class=\"btn-separator\"></div>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Background color\">\n			<i class=\"fa fa-align-left\"></i>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Background color\">\n			<i class=\"fa fa-align-center\"></i>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Background color\">\n			<i class=\"fa fa-align-right\"></i>\n		</button>\n		<button type=\"button\" class=\"btn btn-default disabled\" title=\"Background color\">\n			<i class=\"fa fa-align-justify\"></i>\n		</button>\n	</div>\n	<iframe class=\"badd-editor-browser\"></iframe>\n	<div class=\"badd-editor-browser-footer\"></div>\n</div>");
$templateCache.put("badd-editor.html","<table class=\"badd-editor\">\n	<tr>\n		<td class=\"badd-editor-components\">\n			<div class=\"badd-editor-components\">\n				<p class=\"badd-editor-title\">{{componentsTitle}}</p>\n				<ul>\n					<li ng-repeat=\"draggable in draggables\" data-element=\"{{draggable.element}}\" badd-draggable>\n						<i class=\"fa {{draggable.icon}}\"></i>\n						<span class=\"badd-editor-title\">{{draggable.title}}</span>\n					</li>\n				</ul>\n			</div>\n		</td>\n		<td class=\"badd-editor-browser\">\n			<badd-droppable-frame template=\"{{template}}\"></badd-droppable-frame>\n		</td>\n	</tr>\n</table>");}]);