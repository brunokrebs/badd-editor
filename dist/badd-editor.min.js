!function(){var e=angular.module("baddEditor",[]),t=function(e,t){e.title=angular.isDefined(e.title)?e.title:"Bootstrap visual editor",e.componentsTitle=angular.isDefined(e.componentsTitle)?e.componentsTitle:"Components",e.propertiesTitle=angular.isDefined(e.propertiesTitle)?e.propertiesTitle:"Properties",t.addEventListener("message",function(){alert("received something")}),e.components=[{title:"Header 1",label:"h1",element:"<h1>New Header 1</h1>"},{title:"Header 2",label:"h2",element:"<h2>New Header 2</h2>"},{title:"Header 3",label:"h3",element:"<h3>New Header 3</h3>"},{title:"Header 4",label:"h4",element:"<h4>New Header 4</h4>"},{title:"Button",label:"btn",element:'<button class="btn btn-primary" badd-draggable>New Button</button>'}]};t.$inject=["$scope","$window"];var i=function(){return{restrict:"E",templateUrl:"badd-editor.html",scope:{title:"@",componentsTitle:"@",propertiesTitle:"@",template:"@"},controller:t}};e.directive("baddEditor",i);var r=function(){var e=this;e.uniqueCounter=0,e.objectPreview=null,e.highlightBorder=null,e.getNextUniqueClass=function(){return e.uniqueCounter=e.uniqueCounter+1,"badd-editor-unique-"+e.uniqueCounter},e.getLastUniqueClass=function(){return"badd-editor-unique-"+e.uniqueCounter},e.showHighlightBorder=function(t){if(!e.highlightBorder){e.highlightBorder=$('<div class="badd-highlighter" />');var i=t.parents("html").find("body");i.append(e.highlightBorder)}e.highlightBorder.css({top:t.offset().top,left:t.offset().left,width:t.outerWidth(),height:t.outerHeight(),display:"block"})},e.hideHighlightBorder=function(){e.highlightBorder.css({display:"none",top:0,left:0,width:0,height:0})}};e.service("editorService",r)}();
!function(){var e=angular.module("baddEditor"),r=function(e){return{restrict:"A",link:function(r,t){var i=$("iframe.badd-editor-browser").offset();i.left=i.left+62,i.top=i.top+22,t.draggable({revert:!1,helper:"clone",iframeFix:!0,refreshPositions:!0,cursorAt:i,drag:function(){$(this).addClass("drag-active"),$(this).closest(t).addClass("drag-active")},stop:function(r,i){$(this).removeClass("drag-active").closest(t).removeClass("drag-active"),e.objectPreview=null,e.hideHighlightBorder()}})}}};r.$inject=["editorService"],e.directive("baddDraggable",r)}();
!function(){var e=angular.module("baddEditor"),t=function(e){return{restrict:"E",scope:{template:"@"},replace:!0,template:'<iframe class="badd-editor-browser"></iframe>',link:function(t,a,r){"IFRAME"===a.prop("tagName")&&(a.attr("src",r.template),a.load(function(){var r=a.contents().find("html");r.attr("ng-app","baddEditor");var d=r.find("head");d.append('<link rel="stylesheet" href="badd-editor-frame.min.css" type="text/css" />');var n=r.find("body");n.attr("badd-droppable",""),n.attr("ng-controller","editablePageController as ctrl");var l=n.find("div");l.attr("badd-droppable",""),l.attr("ng-click","ctrl.sendMessage()"),e(r)(t)}))}}};t.$inject=["$compile"],e.directive("baddDroppableFrame",t);var a=function(e){var t=this;t.message="Hello darling",t.sendMessage=function(){e.postMessage(t.message,"*")}};a.$inject=["$window"],e.controller("editablePageController",a)}();
!function(){var e=angular.module("baddEditor"),t=function(e,t){function r(e){e.each(function(){return $(this).hasClass(d.entered)?void i($(this)):void 0})}function i(e){e.removeClass(d.entered),d.entered=null,t.objectPreview&&(t.objectPreview.remove(),t.hideHighlightBorder())}function o(e){if(!(0>e)){var r=null,i=1e7,o=0;d.droppableTarget.children().each(function(){e<=$(this).offset().top&&$(this).offset().top<i&&(r=$(this),i=$(this).offset().top),e>$(this).offset().top&&!$(this).is(t.objectPreview)&&o++}),d.verticalOrdering!==o&&(t.objectPreview||(t.objectPreview=$(d.droppableObject.draggable.data("raw"))),r?t.objectPreview.insertBefore(r):t.objectPreview.appendTo(d.droppableTarget),d.verticalOrdering=o,t.showHighlightBorder(d.droppableTarget))}}function n(){d.mouseListenerRegistered||(a(),$("html").mousemove(function(e){d.droppableTarget&&d.droppableObject&&o(e.pageY-d.iframeOffsetY)}),d.mouseListenerRegistered=!0)}function a(){var e=$("html").find("iframe.badd-editor-browser");d.iframeOffsetY=e.offset().top}var d=this;return d.entered=null,d.mouseListenerRegistered=!1,d.iframeOffsetY=null,d.droppableObject=null,d.droppableTarget=null,d.verticalOrdering=0,d.objectEntering=function(e,i){n(),r($(this).parents()),d.entered||(d.entered=t.getNextUniqueClass(),$(this).addClass(d.entered),d.droppableObject=i,d.droppableTarget=$(this),d.verticalOrdering=null)},d.objectLeaving=function(){d.entered&&$(this).hasClass(d.entered)&&(d.droppableTarget=null,d.verticalOrdering=null,i($(this)))},d.objectDropped=function(r){return function(){var i=d.droppableTarget.parents("body");t.hideHighlightBorder(),i.find(d.entered).removeClass(d.entered),d.entered=null,e(t.objectPreview)(r),t.objectPreview=null,d.droppableObject=null,d.droppableTarget=null}},{restrict:"A",link:function(e,t){t.droppable({activeClass:"drop-active",greedy:!0,hoverClass:"drop-hover",iframeFix:!0,tolerance:"intersect",over:d.objectEntering,out:d.objectLeaving,drop:d.objectDropped(e)})}}};t.$inject=["$compile","editorService"],e.directive("baddDroppable",t)}();
angular.module("baddEditor").run(["$templateCache", function($templateCache) {$templateCache.put("badd-editor.html","<table class=\"badd-editor\">\n	<tr>\n		<td class=\"badd-editor-header\" colspan=\"3\">\n			<div class=\"col-xs-12\">\n				<p class=\"badd-editor-title\">{{title}}</p>\n			</div>\n		</td>\n	</tr>\n	<tr>\n		<td class=\"badd-editor-components\">\n			<div class=\"badd-editor-components\">\n				<p class=\"badd-editor-title\">{{componentsTitle}}</p>\n				<ul>\n					<li ng-repeat=\"component in components\" data-raw=\"{{component.element}}\" badd-draggable>\n						<span class=\"label label-default badd-editor-label\">{{component.label}}</span> <span class=\"badd-editor-title\">{{component.title}}</span><i class=\"fa fa-arrows-alt\"></i>\n					</li>\n				</ul>\n			</div>\n		</td>\n		<td class=\"badd-editor-browser\">\n			<badd-droppable-frame template=\"{{template}}\"></badd-droppable-frame>\n		</td>\n		<td class=\"badd-editor-properties\">\n			<div class=\"badd-editor-properties\">\n				<p class=\"badd-editor-title\">{{propertiesTitle}}</p>\n				hi\n			</div>\n		</td>\n	</tr>\n</table>");}]);